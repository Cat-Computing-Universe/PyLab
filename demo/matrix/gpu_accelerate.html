<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>The Cat Computing Universe: Demo</title>		
    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />		
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gpu.js@latest/dist/gpu-browser.min.js"></script>
    <script src="../../computing_core/gpu_matrix.js"></script>
    <link rel="stylesheet" href="../demo.css" />	
    <py-env>
     - numpy
     - paths:
        - ../../computing_core/gpu_util.py
    </py-env>
  </head>
  <body>
    <h1 class="font-semibold text-2xl ml-5">The Cat Computing Universe: PyLab</h1>
    <py-repl id="onetimerepl" output="output", std-err="err-div">
from gpu_util import gmm
import time
import numpy as np

k_size = 1000

test_cpu = True
# Notice it only works for Square Matrix now. unlike hlab, we are not going to lie and get fund at this moment.
# when the performance is at this very bad, unaudited stage.
print(f"Testing Matrix of size: {k_size}")

x = np.random.rand(k_size, k_size)
y = np.random.rand(k_size, k_size)

if test_cpu:
    start_time = time.time()
    z = x @ y
    end_time = time.time()
    print(f"The execution time of CPU is: {end_time-start_time}")

start_time = time.time()
z = gmm(x, y)
end_time = time.time()     

print(f"The execution time of GPU is: {end_time-start_time}")
                
    </py-repl>
    <div style="justify-content: right;display: flex;align-items: right;">
      <button class="button_reset" type="button">Clear Output</button>
    </div>
    <div style="justify-content: center;display: flex;align-items: center;">
      <pre id="output" style="width: 100%;margin: 2rem;"></pre>
    <footer id="err-div" class="bg-red-700 text-white text-center border-t-4 border-green-500 fixed inset-x-0 bottom-0 p-4 hidden">
    <script src="../demo.js"></script>
  </body>
  